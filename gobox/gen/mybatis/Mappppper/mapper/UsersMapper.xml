<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://raw.githubusercontent.com/ltto/GoMybatis/master/mybatis-3-mapper.dtd">
<mapper>
    <!--logic_enable 逻辑删除字段-->
    <!--logic_deleted 逻辑删除已删除字段-->
    <!--logic_undelete 逻辑删除 未删除字段-->
    <!--version_enable 乐观锁版本字段,支持int,int8,int16,int32,int64-->
    <resultMap id="BaseResultMap" tables="biz_user_address">
        <id column="id" property="Id" langType="int"/>
        <result column="nick" property="Nick" langType="string"/>
        <result column="openID" property="OpenID" langType="string"/>
        <result column="createdAt" property="CreatedAt" langType="time.Time"/>
        <result column="updatedAt" property="UpdatedAt" langType="time.Time"/>
        <result column="deletedAt" property="DeletedAt" langType="time.Time"/>

    </resultMap>

    <sql id="base">
        `id`, `nick`, `openID`, `createdAt`, `updatedAt`, `deletedAt`
    </sql>
    <!-- insert -->
    <insert id="Save" useGeneratedKeys="true">
        INSERT INTO `users`(<include refid="base"/>) VALUES( null, #{obj.Nick}, #{obj.OpenID}, #{obj.CreatedAt}, #{obj.UpdatedAt}, #{obj.DeletedAt})
    </insert>
    <!-- selectOne -->
    <select id="SelectByID">
        SELECT
        <include refid="base"/>
        FROM `users` WhERE `id` = #{id}
    </select>

    <select id="SelectLimit">
        SELECT
        <include refid="base"/>
        FROM `users`
        limit #{o},#{l}
    </select>

	<select id="SelectCount">
        SELECT count(1) FROM `users`
    </select>

    <!-- update -->
    <update id="UpdateByID">
        UPDATE `users` SET `id`=#{obj.id} 
        <if test="obj.Id.Valid">,`id` = #{obj.Id}</if>
        <if test="obj.Nick.Valid">,`nick` = #{obj.Nick}</if>
        <if test="obj.OpenID.Valid">,`openID` = #{obj.OpenID}</if>
        <if test="obj.CreatedAt.Valid">,`createdAt` = #{obj.CreatedAt}</if>
        <if test="obj.UpdatedAt.Valid">,`updatedAt` = #{obj.UpdatedAt}</if>
        <if test="obj.DeletedAt.Valid">,`deletedAt` = #{obj.DeletedAt}</if>
        WHERE `id`=#{obj.id}
    </update>

    <!--delete one-->
    <delete id="DeleteByID">
        delete FROM `users` WHERE `id`=#{id}
    </delete>

    <!-- delete list -->
    <delete id="DeleteByIDs">
        delete FROM `users` WHERE `id` in
        <foreach item="item" index="index" collection="ids" open="(" separator="," close=")">#{item}</foreach>
    </delete>
</mapper>
